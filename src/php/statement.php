<?php
require_once('functions.php');

/** Εξάγει μια υπεύθυνη δήλωση.
 * @param array $data Τα δεδομένα της υπεύθυνης δήλωσης */
function statement($data) { ?>

\sectd\sbkodd\pgwsxn11906\pghsxn16838\marglsxn1417\margrsxn1417\margtsxn1134\margbsxn1134\pgbrdrt\brdrs\brdrw1\brsp57\pgbrdrb\brdrs\brdrw1\brsp283\pgbrdrl\brdrs\brdrw1\brsp283\pgbrdrr\brdrs\brdrw1\brsp283\pgbrdrhead\pgbrdrfoot

\pard\plain\sl360\slmult1\qc
{\pict\picw230\pich231\picwgoal1134\pichgoal1134\pngblip
89504E470D0A1A0A0000000D49484452000000E6000000E7010300000030F8B85D00000006504C5445000000FFFFFFA5D99FDD0000090949444154785E7DD94D6FE3C61D06F03104945960BBCC314137668216CD35810FB11A4583A287A068D17E85001BC4576F7588DC281A190EA2025D2C0F3E34061CCDB1D704B9A44011CB101AA2A8E339175DAC2968E1B92C226A278838F0DFF3EF5014ADB7D1EA40D0FC81F33CA4C8914C115C78E985BF604953FF391A68E2ADD534D029F1D769975F2392350A1E074408DCDA62DC58683B35F5901B86D8776A0B91220D31650E051FB9D5DED05087C6D8AC32084612B943DBA6DE6489801D1E3934E8F4017BD278FCDEAA023B8E0043856DF1E6AAA6C34AA031E89B0DB1BDAA4A54A80246D2FAF0785525DF2DC934DD64C6EB34E8B20AFE9B5E34EA2245EFA2B2A2BCE363386823C70DB1AAB41260102146E9F61F3B6C490D7B75C3D010B1A78D2FAE16151AE8F581ED634C104A51B2A415F031C52E210D1AEFDE4BE8829E9593160E10BB88BE84FBCA5FD0DB5B8394E517450F3155D1BC1A5FD94530D18422D446F39A0A8998B0BC3D21E4ED745EFB564DA9B80C48F03343E73412B66D90639E1DCC692848703143ECA398A9A16774E9569433858FBA0BD8D74335D354F79654A6331DA970B8A0D7EA11BB5129F9C2CE0AF4E399864B8A905ED01B0DC4921AB8E0851A1A9EC845FD201085C2879CE2A2BE17C81B957449B1FECA8DEA31654B4AEFAA42D58FCD653D39D385CA55E5FF9A696256B47F5DA8183D584214F71F157A3EBABBAC72E371A19DDDC68AEECFF4BE5E56058FD954BFD959510D9D42AB3B2A268BAFB2D92C94DED9EA2E69E5DB1B652FECB496B4FA5E3055C3F685B7944B2B019DEA4EFB7C4539BF51DA5951210A1DD3CD159585C28FACEA4D6A510B49B6E251250B7DF6417345B5A457B9269F9815054547537D6955CDD6C954D33D3369359BF2DB145FFEC7935C9572E85FBF78C232BD56D2A1E28BEF739522579857F985A056C7D7436EBCEE522B542713953F45EA507DC2B9D5C12DC31C2343AEBD5B808E5640E985D523AD5D6A022A26AA5C8A01CBB4A22374E462A726271AA2A3333E9C68B34E5D3A3A536320A659AFB9468ECFAE945556EFBB5AC54FAEBE0202A2ECD451FFEAED4CB79C8AA3AB32906BF1959A6F95E6AD32DD03A2451B9D47A47EF5F1F3F4A506902B11A2F35CA9BF001025043A5BA9EE73757406445A75E68EF53990CBEF86EBB463F5B7D2A917561B44FC4E3A3B87977B55AB25E96CD596E54CDB1298430FE5674DABD138755DB165D93556C578C01CADB665DFEA851847D4A1951DFD63831C9DD742EAE85CDDD1970D727C5EA3D4D18AFD722FD3DF3F73A9619FEE9D3748E756C24E5C1A951F3648782BC113C7ACC2E451C7EAC168EC54F55D15888894E4CBEA53F3D1286E5A1D66BA324F1AAD9346A65B7D975E430A40CEBEAF3915CCC7B9464EC577AE817CFBBE12270E35B557F4F3F473ABF2B5317729DBFAEECAEABEE4D4A9420119F4E4A14B3FFC4A662A872597D60EC7128892C277693D52B952B6AAD87857092023D969BAB4EAFDD7AA5EA3B47DC433AD18979EC8E36D20A9AC3C42877275BCDD20F07DE3B653AF8EEB564DFD1D978ABD8ED587CD54BBF4BCD26140EE349453E5830E8B33554E8DABAC45C2B274AA4A68F3458265299D0AB4512778289CAA91BE9958FDB7702920FF79427874C071F55E40C3849790306AAFAA67958A20216D11509762206942BE1455E65471C912F2F5798339E7C9410209F9E71F1AEED97B34B27A725BBB35557B561F28B7C24EA6A7D2ADE8EDFD404E06029D9D31ACFD403E1FF135CAAD1EA7D43DF3237DFD09E934983BD7EAFBA4D35CA386DD7E9FF0B7E83A7DE18955EE5610FB560FDD473406D17EBA5607D7437E462E7AD2A97D2DE91939EBB9CFF3532DB7AD96DC7AA62EEF3F22A2B4072E3DAF3DBB774CC4A092BAF4626BD73F26435D495D9F56FCAD7A50215257FFCC1C9D79BBCEAC42B5461D4ADB65D320F2986E51472E8D32559FD2D7F9AA1A166D011015BFFD7797D6E4D603203ADD6A0B5C528F1A25FFF6B25593A9E3FBB3FC640F0864B7F7AA5EAB714B591DFF4FA8D591B5523DABE6FE7F56F561A6425AADDF13E565BD43D55871AB582D890A1E2CEBE5878A0BABFC4054D841BCD0EA0E95AFD74E320D07E29B65DDA4E21735CAAD0A2D383D4816F42EE3AD2B1A58955A1CF1D3855CA830BE7F85D4EA08C4E192A675467BCA30AB299CF544BCA0B1D5A102B40ACDA7EF8A98CDEB4662F684D299221D7A32A1F3AD4A71A6838986B22DD3A03BA7C1295C9FD7A2894652D6169FD36109E0D1D89FA892973528CD23583D7A4227AAE5E59E216C4E634F9B525CFC5FB6ABB195C74E837D8DDE2057F3A7173566A5C886453229AF87BE1013C5ADFD6B4CF2AD984E94A92115ED5C0FFB4F1126EAE763945049CA73153D7D86F9666F924F0254CFD854DBFD6BAB8856364C1E9E291DE63A82C713B5A1C5B3A171CA2816DAC91549BD345530AFE58AA9D964B9B6DEF07395106F4C154C75AAF1AB74AA09F9A850566842D85409AA5C81F885A6A438D314C78592426163AAA7883257C3E02753355335BE188A5C916277AA589A2650210AE5B3E7A8ED5C47C8033E5541D15BD44874289D6A14F2FE5445660186E233C3A62A7B3C65334D02432FDE8442D5487C930517BD2930EE014E55C30E6F63313809A846EEEB42013D3EC0386F96F848D5B043D44C0F448AAA55CA741F0D8BC4D72359A861A7A2C294213E2204F89885FC4B14856285ECF04023B61826889BC86D0D7EA3D4947808230D3EF68CA9203DF190DE28B7C112EA753CC5105230AC429AEC46059ECA91A9DE6169931EF735E01B0878A3514C76520C7A5BA6C28EA291C612EA99CAB129010B93321EC9B2AF34FAA866AAB2C3A491B98BBDE136950A088B66AA1163E483D86E14F540CA2466E14C010DA1918E77A978BCEB89A88718CCD4D0947A0360101C75DE451E7A086CA6185CE169D2A4A957EEF8C8EF129AE29C46082F34FDB015D7AA0156B7133A98D73EC64D3CED71A86D936ADD427B5E5336B68B1711C6AF21FC1A118279357EB624544B0FD312628CF38A2D040F635F4B1F13E2A7DE4C8B498A99927A4282F82E217451B11B8087DD9D183174FFFAD045F04F1103B7A63E062DCF50E952435BA6BA594A71E0D420BD5B67D8C79E5B716384D85EB32FC5DE18A1B4F6D7161F318EFD350A144D0989EFD604631220786E3D00E2D958E9D4344818C66C8D76F100B360B78693F73C0EDCCA6366D5ACE9DC29E5F16EEDD262CDA5035CD1FF03F49E3163897FFC5D0000000049454E44AE426082}\line
\fs28\b ΥΠΕΥΘΥΝΗ ΔΗΛΩΣΗ\line\fs20 (άρθρο 8 Ν.1599/1986)\b0\par

\pard\plain\trowd\trpaddl57\trpaddr57
\clbrdrt\brdrs\brdrw1\clbrdrb\brdrs\brdrw1\clbrdrl\brdrs\brdrw1\clbrdrr\brdrs\brdrw1\cellx9071
\fs20\qc Η ακρίβεια των στοιχείων που υποβάλλονται με αυτή τη δήλωση μπορεί να ελεγχθεί με βάση το αρχείο άλλων υπηρεσιών (άρθρο 8 παρ. 4 Ν. 1599/1986)\cell\row
\pard\plain\trowd\trpaddl57\trpaddr57
\clbrdrb\brdrs\brdrw1\clbrdrl\brdrs\brdrw1\clbrdrr\brdrs\brdrw1\cellx2551
\clvertalc\clbrdrb\brdrs\brdrw1\clbrdrr\brdrs\brdrw1\cellx9071
{\fs20 ΠΡΟΣ:}\cell <?=rtf($data['Προς'])?>\cell\row
{\fs20 Ονοματεπώνυμο:}\cell <?=rtf($data['Ονοματεπώνυμο'])?>\cell\row
{\fs20 Ονοματεπώνυμο Πατέρα:}\cell <?=rtf($data['Ονοματεπώνυμο Πατέρα'])?>\cell\row
{\fs20 Ονοματεπώνυμο Μητέρας:}\cell <?=rtf($data['Ονοματεπώνυμο Μητέρας'])?>\cell\row
{\fs20 Ημερομηνία Γέννησης:}\cell <?=isset($data['Ημερομηνία Γέννησης']) && $data['Ημερομηνία Γέννησης'] != '' ? chk_date($data['Ημερομηνία Γέννησης']) : null?>\cell\row
{\fs20 Τόπος Γέννησης:}\cell <?=rtf($data['Τόπος Γέννησης'])?>\cell\row
{\fs20 ΑΔΤ:}\cell <?=rtf($data['Αριθμός Ταυτότητας'])?>\cell\row
{\fs20 Τηλέφωνο:}\cell <?=rtf($data['Τηλέφωνο'])?>\cell\row
{\fs20 Τόπος Κατοικίας\line (Πόλη, Οδός, Αριθμός, ΤΚ):}\cell <?=rtf($data['Διεύθυνση Κατοικίας'])?>\cell\row
{\fs20 e-mail:}\cell <?=isset($data['e-mail']) ? rtf($data['e-mail']) : null?>\cell\row

\pard\plain\sa60\sb60\fi567\tx1134\tx1701\qj
{\fs22 Με ατομική μου ευθύνη και γνωρίζοντας τις κυρώσεις, που προβλέπονται από τις διατάξεις της παρ. 6 του άρθρου 22 του Ν. 1599/1986, δηλώνω ότι:}\par
<?php if ($data) { ?>
<?=$data['Δήλωση']?>\par\par
<?php } else { ?>
\pard\plain\trowd\trpaddl57\trpaddr57
\clbrdrb\brdrdot\brdrw1\cellx9071
\fs32\cell\row\cell\row\cell\row\cell\row\cell\row\cell\row\cell\row\cell\row\cell\row\cell\row\cell\row\cell\row\cell\row\cell\row\cell\row
\pard\plain\par\par
<?php } ?>

\pard\plain\qc
\trowd\trpaddl0\trpaddr0\cellx4535\cellx9071
ΘΕΩΡΗΘΗΚΕ ΓΙΑ ΤΟ\line ΓΝΗΣΙΟ ΤΗΣ ΥΠΟΓΡΑΦΗΣ\cell
<?php
if (!$data || isset($data['Ημερομηνία Έκδοσης']) && $data['Ημερομηνία Έκδοσης'] == '')
		echo '..................\line{\fs16 (Ημερομηνία)}';
else if (isset($data['Ημερομηνία Έκδοσης']))
		echo chk_date($data['Ημερομηνία Έκδοσης']);
	else echo strftime('%d %b %y', time());
?>
\line\line
Ο Δηλών:\line\line\line <?=$data && $data['Ονοματεπώνυμο'] != '' ? rtf($data['Ονοματεπώνυμο']) : '............................\line{\fs16 (Ονοματεπώνυμο & Υπογραφή)}'?>\cell\row

\sect

<?php
}

/** Εξάγει μια υπεύθυνη δήλωση δικαιούχου.
 * Αν τα δεδομένα $data είναι δαπάνη, εξάγει για όλους τους ιδιώτες δικαιούχους των τιμολογίων την
 * αντίστοιχη υπεύθυνη δήλωση. Αν δεν είναι δαπάνη, θεωρεί ότι είναι τα δεδομένα ενός δικαιούχου,
 * οπότε εξάγει την αντίστοιχη υπεύθυνη δήλωση μόνο γι' αυτόν.
 * @param callable $function Κλήση που επεξεργάζεται τα δεδομένα */
function statement_common($function) {
	global $data;
	foreach($data['Δικαιούχοι'] as $per_contractor) {
		$v = $per_contractor['Δικαιούχος'];
		if ($v['Τύπος'] == 'Ιδιωτικός Τομέας') {
			$v['Ημερομηνία Έκδοσης'] =
					strftime('%d %b %y', get_newer_timestamp($per_contractor['Τιμολόγια']));
			$function($v);
		}
	}
}

/** Εξάγει μια υπεύθυνη δήλωση δικαιούχου.
 * @param array $data Τα δεδομένα της υπεύθυνης δήλωσης */
function statement_contractor($data) {
	$data['Προς'] = 'ΔΟΥ';
	if (!isset($data['Ονοματεπώνυμο'])) $data['Ονοματεπώνυμο'] = $data['Επωνυμία'];
	if (!isset($data['Διεύθυνση Κατοικίας'])) $data['Διεύθυνση Κατοικίας'] = $data['Διεύθυνση'];
	statement($data);
}

/** Εξάγει μια υπεύθυνη δήλωση δικαιούχου που γνωστοποιεί το IBAN.
 * @param array $contractor Τα δεδομένα ενός δικαιούχου */
function statement_IBAN($contractor) {
	$contractor['Δήλωση'] = 'Το χρηματικό ποσό που δικαιούμαι να εισπράξω σαν «{\b '
			. rtf($contractor['Επωνυμία']) . '}», ΑΦΜ: ' . rtf($contractor['ΑΦΜ']) . ', τηλέφωνο: '
			. rtf($contractor['Τηλέφωνο']) . ', να κατατεθεί στο λογαριασμό IBAN {\b '
			. iban($contractor['ΙΒΑΝ']) . '} ({\b ' . bank($contractor['ΙΒΑΝ'])
			. '}).\par Επισυνάπτεται φωτοτυπία του βιβλιαρίου καταθέσεων.';
	statement_contractor($contractor);
}

/** Εξάγει μια υπεύθυνη δήλωση δικαιούχου ότι δε χρησιμοποιεί απόστρατο αντιπρόσωπο.
 * @param array $contractor Τα δεδομένα ενός δικαιούχου */
function statement_representative($contractor) {
	$contractor['Δήλωση'] = 'Σαν «' . rtf($contractor['Επωνυμία']) . '», δε θα χρησιμοποιήσω σαν άμεσο ή έμμεσο αντιπρόσωπο, μόνιμο ή σε εφεδρεία Αξιωματικό των τριών κλάδων των Ενόπλων Δυνάμεων, εφόσον δεν έχει παρέλθει πενταετία από τον χρόνο αποστρατείας τους, σύμφωνα με την παράγραφο 12 του άρθρου 66 του ΝΔ 1400/73 (ΦΕΚ Α\' 114), όπως τροποποιήθηκε και ισχύει.';
	statement_contractor($contractor);
}

/** Εξάγει την υπεύθυνη δήλωση της αντίστοιχης φόρμας του γραφικού περιβάλλοντος. */
function statement_gui() {
	global $data;
	$data['Δήλωση'] = str_replace(array("\r\n", "\r", "\n"), '\par ', str_replace("\t", '\tab ', rtf($data['Δήλωση'])));
	statement($data);
}